# Reproducing published results on paraboloid-polytope intersection

This document explains how to reproduce the results presented in our journal paper on paraboloid-polytope intersection, published in the SIAM Journal on Scientific Computing [link](). 

A preprint of this article is available in [arXiv](https://arxiv.org/pdf/2210.07772.pdf) as well as in the [current repository](manuscript_paraboloid_intersection.pdf).
## Unit cube translation (Section 7.1)

In order to reproduce Figures 5 and 6 of the [paper](), it is necessary to build the unit tests of IRL (for which the option `-D BUILD_TESTING=ON` must be provided when building IRL itself). This requires executing the additional command:

```
make irl_test
```

Once the unit tests have been built, the paraboloid-polyhedron intersections shown in Figure 5 of the [paper]() can be generated by executing:

```
./tests/bin/irl_test --gtest_filter=ParaboloidIntersection.SISCPaperFig5
```

This will generate a set of STL files which can be viewed with most visualization softwares (e.g., [Paraview](https://www.paraview.org/)). The files used to generate Figure 5 of  the [paper]() are:
[```
](https://github.com/fabienevrard/irl-paraboloid-testing)clipped_surface_*.stl
unclipped_cube_*.stl
```
resulting in the following visualizations:
|<img src="./figures/figure5a.png" style="max-width:30%; object-fit: contain;"/>|<img src="./figures/figure5b.png" style="max-width:30%; object-fit: contain;"/>|<img src="./figures/figure5c.png" style="max-width:30%; object-fit: contain;"/>|
|:---:|:---:|:---:|
|Fig. 5a|Fig. 5b|Fig. 5c|

The exact moments and estimation errors plotted in Figure 6 of the [paper]() can be generated by executing:
```
./tests/bin/irl_test --gtest_filter=ParaboloidIntersection.SISCPaperFig6
```

This produces a text file named `fig6.txt` containing the raw data (i.e., the *unscaled* moments and associated estimation errors) used for generating the plots in Figure 6, shown here:

|<img src="./figures/figure6a.png" style="max-width:30%; object-fit: contain;"/>|<img src="./figures/figure6b.png" style="max-width:30%; object-fit: contain;"/>|
|:---:|:---:|
|Fig. 6: Exact moments|Fig. 6: Errors|

## Parameter sweep study (Section 7.2)

The moment estimation errors and execution times resulting from the graded and random parameter sweeps of Section 7.2, presented in Tables 2, 3, 4, and 6, have been generated using our [testing suite](https://github.com/fabienevrard/irl-paraboloid-testing).

This project can be cloned and built using:
```
git clone https://github.com/fabienevrard/irl-paraboloid-testing.git
cd irl-paraboloid-testing
mkdir build
cmake -DIRL_ROOT_LOCATION=<path_to_IRL_project_directory> -DIRL_INSTALL_LOCATION=<path_to_IRL_install_directory> -DEIGEN_DIR=<path_to_eigen_directory> ..
make
```
This will generate two executables named `amr_generate_result` and `irl_confirm_result`. 

As the name indicates, `amr_generate_result` produces reference results for our parameter sweeps using AMR (adaptive mesh-refinement) of the clipped polyhedron's faces. It takes an input file in the JSON format, which read as:
```
{
    "test_name": "parameter_sweep", [* <- chosen between: parameter_sweep and translating_cube *]{style="float:right"} 
    "out_file_name": "sweep_cube.bin",
    "Sweep": {
        "geometry": "cube",
        "random": false,
        "fix_to_paraboloid": false,
        "translation": [
            [
                -0.5,
                -0.5,
                -0.5
            ],
            [
                0.5,
                0.5,
                0.5
            ]
        ],
        "rotation": [
            [
                0.0,
                0.0,
                0.0
            ],
            [
                3.1415926535897932384626433832795028841971693993751058209749445923,
                3.1415926535897932384626433832795028841971693993751058209749445923,
                3.1415926535897932384626433832795028841971693993751058209749445923
            ]
        ],
        "coefficient": [
            [
                -5.0,
                -5.0
            ],
            [
                5.0,
                5.0
            ]
        ],
        "translation_steps": [
            5,
            5,
            5
        ],
        "rotation_steps": [
            5,
            5,
            5
        ],
        "coefficient_steps": [
            11,
            11
        ]
    }
}
```
